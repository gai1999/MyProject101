{% extends 'blog/base.html' %}
{% load static %}
{% block style %}
    <link rel="stylesheet" href="{% static 'css/blog/postlist.css' %}">
    <script type="application/javascript">


    </script>
{% endblock %}

{% block title %}
    {% if tag %}
        标签页: {{ tag.name }}
    {% elif category %}
        分类页: {{ category.name }}
    {% else %}
        首页
    {% endif %}
{% endblock %}



{% block content %}
    {{ block.super }}
    {# 首页轮播图 #}
    <div id="sticky_posts_carousel_container">
        <div id="carouselExampleCaptions" class="carousel slide"
             data-ride="carousel">
            <ol class="carousel-indicators">
                {% for top_post in top_posts %}
                    {% ifequal forloop.counter0 0 %}
                        <li data-target="#carouselExampleCaptions"
                            data-slide-to="{{ forloop.counter0 }}"
                            class="active"></li>
                    {% else %}
                        <li data-target="#carouselExampleCaptions"
                            data-slide-to="{{ forloop.counter0 }}"></li>
                    {% endifequal %}

                {% endfor %}

            </ol>


            <div class="carousel-inner">
                {% for top_post in top_posts %}
                    {% ifequal forloop.counter0 0 %}
                        <div class="carousel-item active" data-interval="3500">
                            <a href="{% url 'post' top_post.id %}">
                                <img src="{{ top_post.top_carousel_image.url }}"
                                     class="d-block w-100" alt="..."></a>
                            <div class="carousel-caption d-none d-block">
                                <h5 id="top_post_title_pc"
                                    style="color: #FF6600">{{ top_post.title }}</h5>
                                <span id="top_post_title_mobile"
                                      style="color: #FF6600; font-size: 14px">{{ top_post.title }}</span>
                            </div>
                        </div>
                    {% else %}
                        <div class="carousel-item" data-interval="3500">
                            <a href="{% url 'post' top_post.id %}">
                                <img src="{{ top_post.top_carousel_image.url }}"
                                     class="d-block w-100" alt="..."></a>
                            <div class="carousel-caption d-none d-block">
                                <h5 id="top_post_title_pc"
                                    style="color: #FF6600">{{ top_post.title }}</h5>
                                <span id="top_post_title_mobile"
                                      style="color: #FF6600; font-size: 14px">{{ top_post.title }}</span>
                            </div>
                        </div>
                    {% endifequal %}
                {% endfor %}

            </div>
            <a class="carousel-control-prev" href="#carouselExampleCaptions"
               role="button" data-slide="prev">
                <span class="carousel-control-prev-icon"
                      aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carouselExampleCaptions"
               role="button" data-slide="next">
                <span class="carousel-control-next-icon"
                      aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>
    </div>

    {% for post in postlist %}
        {# 新写的文章卡片列#}
        <div class="card post div_boder" style="padding: 10px;"
             onclick="window.open('{% url 'post' post.id %}','_self')">
            {% now 'U' as nt %}
            {% with nt|add:-259200 as bt %}
                {% if post.created_time|date:'U'|add:0 >=  bt %}
                    <div style="overflow: hidden; padding: 15px 0 15px;line-height: 14px; text-align:center;position: absolute; float: left; top: 0; right: 0; width: 50px;height: 50px;z-index: 2;">
                        <span style="display:inline-block;width:80px; text-align:left; padding-left:17px;color:#FFFFFF;background-color: #FF9933; font-size:14px; font-weight:bold;transform:rotate(45deg);">New</span>
                    </div>
                {% endif %}
            {% endwith %}
            <div class="post_read_tag" style="">
                阅读全文

            </div>
            <div class="card_img_cont">
                <span class="silk-ribbon-2"><span>{{ post.category.name }}</span></span>
                <div class="card_img_back">
                    <img class="card_img"
                         src="{{ post.title_image.url }}"
                         alt="">
                </div>

            </div>
            <div class="card_post">
                <div class="card_post_title post_title_font_big">
                    <a class="post_title_font_big"
                       href="{% url 'post' post.id %}">{{ post.title }}</a>
                </div>
                <div class="card_post_desc post_text_font">
                    {{ post.desc }}
                </div>
                <div class="card_post_other post_desc_font">
                    <span class=" desc_font_14">分类: <a class="desc_font_14"
                                                       href="{% url 'category' post.category.id %}">{{ post.category.name }}</a></span>
                    &nbsp;&nbsp;
                    <span class=" desc_font_14">标签:
                        {% for tag in post.tag.all %}
                            <a class="desc_font_14"
                               href="{% url 'tag' tag.id %}">{{ tag.name }}</a>
                        {% endfor %}
                    </span>&nbsp;&nbsp;
                    <span class="card-link post_desc_font">更新时间: {{ post.created_time }}</span>
                </div>
                <div class="card_post_other_minscreen desc_font_14">
                    {{ post.created_time|date:'Y年m月d日' }}
                    &nbsp;&nbsp;
                    <svg class="bi bi-eye" style="margin-bottom: 4px"
                         width="1em" height="1em" viewBox="0 0 16 16"
                         fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd"
                              d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM1.173 8a13.134 13.134 0 0 0 1.66 2.043C4.12 11.332 5.88 12.5 8 12.5c2.12 0 3.879-1.168 5.168-2.457A13.134 13.134 0 0 0 14.828 8a13.133 13.133 0 0 0-1.66-2.043C11.879 4.668 10.119 3.5 8 3.5c-2.12 0-3.879 1.168-5.168 2.457A13.133 13.133 0 0 0 1.172 8z"/>
                        <path fill-rule="evenodd"
                              d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zM4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0z"/>
                    </svg>
                    {{ post.pv }}
                </div>
            </div>
        </div>

    {% endfor %}


    <div id="paginator">
        {% if page_obj %}

            <nav aria-label="...">
                <ul class="pagination pagination-sm">
                    {% if page_obj.has_previous %}
                        <li class="page-item">
                            <a class="page-link"
                               href="?page={{ page_obj.previous_page_number }}">上一页</a>
                        </li>
                    {% else %}
                        <li class="page-item disabled">
                            <a class="page-link" href="#" tabindex="-1"
                               aria-disabled="true">上一页</a>
                        </li>
                    {% endif %}
                    {% for page in paginator.page_range %}
                        {% ifequal page page_obj.number %}
                            <li class="page-item active"><a class="page-link"
                                                            href="?page={{ page }}">{{ page }}</a>
                            </li>
                        {% else %}
                            <li class="page-item"><a class="page-link"
                                                     href="?page={{ page }}">{{ page }}</a>
                            </li>
                        {% endifequal %}

                    {% endfor %}
                    {% if page_obj.has_next %}
                        <li class="page-item">
                            <a class="page-link"
                               href="?page={{ page_obj.next_page_number }}">下一页</a>
                        </li>
                    {% else %}
                        <li class="page-item disabled">
                            <a class="page-link" href="#" tabindex="-1"
                               aria-disabled="true">下一页</a>
                        </li>
                    {% endif %}
                </ul>
            </nav>
        {% endif %}
    </div>

{% endblock %}
